<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ–°åŠ å¡3å¤©è¡Œç¨‹åœ°å›¾ï½œå«OCBCåŠå…¬ä¸LDL-Cé¥®é£Ÿæç¤º</title>
<link rel="manifest" href="./manifest.json">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.awesome-markers/2.0.5/leaflet.awesome-markers.css">
<style>
  html, body, #map { height: 100%; margin: 0; }
  .legend {
    background: rgba(255,255,255,.92);
    padding: 8px 10px;
    border-radius: 6px;
    line-height: 1.4;
    box-shadow: 0 1px 4px rgba(0,0,0,.2);
    font-size: 13px;
  }
  .topbar {
    position: absolute; left: 10px; top: 10px; z-index: 1000;
    background: rgba(255,255,255,.95);
    padding: 8px 10px; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,.15);
    font-size: 14px;
  }
  .topbar b { display:block; margin-bottom:4px;}
  .btn {
    display:inline-block; padding:6px 10px; border-radius:6px; border:1px solid #ddd; cursor:pointer;
    user-select:none; margin-right:6px;
  }
</style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.awesome-markers/2.0.5/leaflet.awesome-markers.js"></script>
<script>
// ---- åŸºç¡€åœ°å›¾ ----
var map = L.map('map', { zoomControl: true }).setView([1.303, 103.9], 12);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19, attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

// ---- è‡ªå®šä¹‰å›¾æ ‡ ----
function amarker(icon, color='blue') {
  return L.AwesomeMarkers.icon({ icon: icon, prefix: 'fa', markerColor: color, iconColor: 'white' });
}

// ---- åœ°ç‚¹æ•°æ® ----
var hotel = { name: "ä¸œæµ·å²¸é…’åº—ï¼ˆç¤ºæ„ï¼‰", coords: [1.305, 103.912],
  html: "<b>ä¸œæµ·å²¸é…’åº—</b><br>å»ºè®®æ—©é¤ï¼šç‡•éº¦ç²¥/å…¨éº¦åå¸ + æ°´æœ + æ— ç³–è±†æµ†<br>æ¯æ—¥å‡ºå‘ç‚¹ä¸è¿”å›ç‚¹" };

var bank = { name: "OCBC Bank æ€»è¡Œ", coords: [1.2842, 103.8503],
  html: "<b>OCBC Bank æ€»è¡Œ</b><br>æ¯æ—¥åŠå…¬ï¼š13:30â€“15:30ï¼ˆé¢„ç•™è·¯ç¨‹ï¼‰<br>å»ºè®®ï¼šå‡ºé—¨å‰å‡†å¤‡æ— ç³–èŒ¶/æ°´" };

// Day 1 â€”â€” æ»¨æµ·æ¹¾æ–‡åŒ–çº¿
var day1 = [
  {name:"æ»¨æµ·æ¹¾èŠ±å›­", coords:[1.2816,103.8636], tip:"ä¸Šåˆ 9:00â€“12:00<br>æ­¥è¡Œä¸è§‚æ™¯æ¸©åº¦é€‚ä¸­<br>åˆé¤å»ºè®®ï¼šçƒ¤ä¸‰æ–‡é±¼ + ç³™ç±³ + å‡‰æ‹Œè”¬èœ"},
  {name:"è‰ºæœ¯ç§‘å­¦åšç‰©é¦†", coords:[1.2864,103.859], tip:"å¯çŸ­æ—¶å‚è§‚ï¼ˆå†·æ°”è¶³ï¼‰"},
  {name:"æ»¨æµ·æ¹¾é‡‘æ²™ç©ºä¸­èŠ±å›­", coords:[1.2834,103.8607], tip:"è§†é‡å¼€é˜”ï¼Œæ‹ç…§ä½³"},
  {name:"é±¼å°¾ç‹®å…¬å›­", coords:[1.2868,103.8545], tip:"ç»å…¸æ‰“å¡ç‚¹"},
  {name:"å…‹æ‹‰ç å¤´", coords:[1.2906,103.8465], tip:"å‚æ™š 16:00â€“18:00 æ…¢èµ°è§‚æ²³æ™¯"},
  {name:"ä½›ç‰™å¯ºï¼ˆç‰›è½¦æ°´ï¼‰", coords:[1.2828,103.844], tip:"å¯é¡ºè·¯å‚è§‚ï¼Œæ¸…æ·¡é¥®æ°´å°‘ç³–"}
];

// Day 2 â€”â€” è´­ç‰©ä¸ç¾æœ¯é¦†
var day2 = [
  {name:"ION Orchardï¼ˆä¹ŒèŠ‚è·¯ï¼‰", coords:[1.3039,103.832], tip:"ä¸Šåˆ 9:00â€“12:00 é€›è¡—"},
  {name:"å°å°åº¦ Tekka Centre", coords:[1.3074,103.8501], tip:"ç•™æ„ä½æ²¹çƒ¹è°ƒï¼Œå°‘æ¤°æµ†"},
  {name:"æ–°åŠ å¡å›½å®¶ç¾æœ¯é¦†", coords:[1.2903,103.8515], tip:"16:00â€“18:00 å‚è§‚ï¼Œå®¤å†…æ­¥è¡Œ"}
];

// Day 3 â€”â€” åœ£æ·˜æ²™ä¼‘é—²
var day3 = [
  {name:"Mount Faber å±±é¡¶/ç¼†è½¦ç«™", coords:[1.2733,103.8198], tip:"ä¸Šåˆ 9:00â€“12:00 å±±é¡¶è½»å¾’æ­¥"},
  {name:"S.E.A. æµ·æ´‹é¦†", coords:[1.2645,103.8206], tip:"åˆåé¿æš‘å‚è§‚"},
  {name:"Siloso Beachï¼ˆç¤ºæ„ï¼‰", coords:[1.264,103.812], tip:"æ³¨æ„è¡¥æ°´ã€é˜²æ™’ï¼Œæ™šé¤å»ºè®®ï¼šçƒ¤é¸¡èƒ¸ + è—œéº¦æ²™æ‹‰"}
];

// ---- å›¾å±‚ä¸é¢œè‰² ----
var gHotel = L.layerGroup().addTo(map);
var gBank  = L.layerGroup().addTo(map);
var g1 = L.layerGroup().addTo(map);
var g2 = L.layerGroup().addTo(map);
var g3 = L.layerGroup().addTo(map);

// é…’åº—ä¸é“¶è¡Œ
L.marker(hotel.coords, {icon: amarker('home','blue')}).addTo(gHotel).bindPopup(hotel.html);
L.marker(bank.coords,  {icon: amarker('briefcase','red')}).addTo(gBank).bindPopup(bank.html);

// å·¥å…·ï¼šæ·»åŠ ä¸€ç»„ç‚¹ä¸æŠ˜çº¿
function addDay(group, arr, colorName){
  var latlngs = [];
  arr.forEach(function(p, idx){
    latlngs.push(p.coords);
    L.marker(p.coords, {icon: amarker('star', colorName)})
      .addTo(group)
      .bindPopup("<b>"+p.name+"</b><br>"+p.tip);
  });
  // ä»é…’åº—å‡ºå‘ï¼Œä¸²è”åˆ°é“¶è¡Œï¼ˆä¸‹åˆå›ºå®šï¼‰ï¼Œå†åˆ°å‚æ™šæ™¯ç‚¹ï¼ˆæŒ‰åˆ—è¡¨ï¼‰
  var path = [hotel.coords].concat(latlngs.slice(0, Math.max(1, latlngs.length-1))).concat([bank.coords, latlngs[latlngs.length-1], hotel.coords]);
  L.polyline(path, {weight: 3}).addTo(group);
}

// ä¸‰å¤©åˆ†åˆ«æ·»åŠ ï¼ˆé¢œè‰²ï¼šDay1 greenã€Day2 orangeã€Day3 purpleï¼‰
addDay(g1, day1, 'green');
addDay(g2, day2, 'orange');
addDay(g3, day3, 'purple');

// å›¾å±‚æ§åˆ¶
L.control.layers(null, {
  "ğŸ¨ é…’åº—": gHotel,
  "ğŸ¦ OCBC åŠå…¬": gBank,
  "ğŸŒ Day 1 æ»¨æµ·æ¹¾æ–‡åŒ–": g1,
  "ğŸ› Day 2 ä¹ŒèŠ‚è·¯+ç¾æœ¯é¦†": g2,
  "ğŸ– Day 3 åœ£æ·˜æ²™": g3
}, {collapsed:false}).addTo(map);

// è§†é‡é€‚é…
var allPts = [hotel.coords, bank.coords]
  .concat(day1.map(d=>d.coords))
  .concat(day2.map(d=>d.coords))
  .concat(day3.map(d=>d.coords));
map.fitBounds(L.latLngBounds(allPts), {padding:[30,30]});

// ç‚¹å‡»åœ°å›¾ä¸´æ—¶åŠ ç‚¹ï¼ˆå¯ç”¨äºè¡¥å……ä¸ªäººå…´è¶£ç‚¹ï¼‰
map.on('click', function(e){
  var lat = e.latlng.lat.toFixed(5), lng = e.latlng.lng.toFixed(5);
  L.marker(e.latlng, {icon: amarker('map-marker','cadetblue')})
    .addTo(map)
    .bindPopup("è‡ªå®šä¹‰æ ‡è®°<br>"+lat+", "+lng)
    .openPopup();
});

// ---- LDL-C æé†’æŒ‰é’® ----
var top = L.control({position:'topleft'});
top.onAdd = function(){
  var div = L.DomUtil.create('div', 'topbar');
  div.innerHTML = '<b>LDL-C é¥®é£Ÿæé†’</b>\
  âœ… å¤šï¼šæ·±æµ·é±¼ã€è”¬æœã€å…¨è°·ç‰©ã€è±†ç±»ã€åšæœ(å°‘é‡)<br>\
  âš ï¸ å°‘/é¿ï¼šæ²¹ç‚¸ã€æ¤°æµ†ã€è‚¥è‚‰ã€å†…è„ã€å«ç³–é¥®æ–™<br>\
  ğŸ’§ å¤šå–æ°´ï¼Œæ­¥è¡Œ 8,000+ æ­¥/æ—¥';
  return div;
};
top.addTo(map);

// æ³¨å†Œ service workerï¼ˆå¯é€‰ï¼‰
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./service-worker.js").catch(console.warn);
}
</script>
</body>
</html>
